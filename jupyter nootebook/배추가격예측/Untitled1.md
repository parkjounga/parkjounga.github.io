```python
import tensorflow.compat.v1 as tf
tf.disable_v2_behavior() 
import numpy as np
from pandas.io.parsers import read_csv #데이터 불러오기 

model =tf.global_variables_initializer() # 모델 초기화 
data = read_csv('price data.csv', sep=',') # 데이터 불러오기 
xy = np.array(data , dtype =np.float32)# 행렬형태로 데이터담기  
              
```


```python
x_data =xy[:,1:-1] #  슬라이싱문법 ~ 오른쪽배고 다가져오기 (가격만빼고 가져오겠다)
y_data = xy[:,[-1]] # 슬라이싱문법 ~ 오른쪽만 (가격)가져오겠다
```


```python
# 플레이스홀더 
X = tf.placeholder(tf.float32,shape=[None,4])  # shape 입력데이터의 형태
Y = tf.placeholder(tf.float32,shape=[None,1])
W = tf.Variable(tf.random_normal([4,1]),name="weight") # 가중치
b = tf.Variable(tf.random_normal([1]),name="bias")     # bias 값              
```


```python
hypothesis = tf.matmul(X,W) +b # 가설값 ~ 선형회귀(행렬의곱) 
```


```python
cost =tf. reduce_mean(tf.square(hypothesis -Y)) # 비교함수의 정의 
                                                #reduce_mean 평균을 내준는 함수  

```


```python
#  최적화 함수 (경사하강)
optimizer  =tf. train. GradientDescentOptimizer(learning_rate=0.000005)
train = optimizer.minimize(cost) # 트레인 시작 
```


```python
sess = tf.Session()
sess.run(tf.global_variables_initializer()) 
```


```python
for step in range(100001):  #학습시작
    cost_, hypo_, _ = sess.run([cost, hypothesis, train], feed_dict={X: x_data, Y: y_data})
    if step % 500 == 0:
        print("#",step,"손실비용:",cost_)
        print("-배추가격:",hypo_[0])
```

    # 0 손실비용: 12761246.0
    -배추가격: [-4.3125196]
    # 500 손실비용: 4206091.5
    -배추가격: [-286.6284]
    # 1000 손실비용: 3797559.0
    -배추가격: [24.249542]
    # 1500 손실비용: 3478209.5
    -배추가격: [307.54248]
    # 2000 손실비용: 3226895.5
    -배추가격: [559.2559]
    # 2500 손실비용: 3028685.8
    -배추가격: [782.901]
    # 3000 손실비용: 2872131.2
    -배추가격: [981.65955]
    # 3500 손실비용: 2748358.2
    -배추가격: [1158.3363]
    # 4000 손실비용: 2650434.8
    -배추가격: [1315.4126]
    # 4500 손실비용: 2572924.0
    -배추가격: [1455.0801]
    # 5000 손실비용: 2511542.5
    -배추가격: [1579.2837]
    # 5500 손실비용: 2462916.0
    -배추가격: [1689.7439]
    # 6000 손실비용: 2424377.8
    -배추가격: [1787.988]
    # 6500 손실비용: 2393820.2
    -배추가격: [1875.3726]
    # 7000 손실비용: 2369578.0
    -배추가격: [1953.1017]
    # 7500 손실비용: 2350332.8
    -배추가격: [2022.2451]
    # 8000 손실비용: 2335042.0
    -배추가격: [2083.7524]
    # 8500 손실비용: 2322880.5
    -배추가격: [2138.4695]
    # 9000 손실비용: 2313195.8
    -배추가격: [2187.146]
    # 9500 손실비용: 2305471.8
    -배추가격: [2230.4504]
    # 10000 손실비용: 2299298.8
    -배추가격: [2268.9766]
    # 10500 손실비용: 2294353.5
    -배추가격: [2303.2517]
    # 11000 손실비용: 2290380.2
    -배추가격: [2333.7458]
    # 11500 손실비용: 2287175.8
    -배추가격: [2360.876]
    # 12000 손실비용: 2284580.2
    -배추가격: [2385.0146]
    # 12500 손실비용: 2282466.2
    -배추가격: [2406.4912]
    # 13000 손실비용: 2280734.2
    -배추가격: [2425.5994]
    # 13500 손실비용: 2279303.2
    -배추가격: [2442.6018]
    # 14000 손실비용: 2278111.5
    -배추가격: [2457.7297]
    # 14500 손실비용: 2277109.2
    -배추가격: [2471.1904]
    # 15000 손실비용: 2276256.2
    -배추가격: [2483.1694]
    # 15500 손실비용: 2275522.0
    -배추가격: [2493.8281]
    # 16000 손실비용: 2274882.0
    -배추가격: [2503.3127]
    # 16500 손실비용: 2274316.0
    -배추가격: [2511.7534]
    # 17000 손실비용: 2273808.8
    -배추가격: [2519.2656]
    # 17500 손실비용: 2273348.0
    -배추가격: [2525.9512]
    # 18000 손실비용: 2272924.5
    -배추가격: [2531.9026]
    # 18500 손실비용: 2272530.2
    -배추가격: [2537.1973]
    # 19000 손실비용: 2272159.0
    -배추가격: [2541.9136]
    # 19500 손실비용: 2271806.5
    -배추가격: [2546.1094]
    # 20000 손실비용: 2271468.8
    -배추가격: [2549.844]
    # 20500 손실비용: 2271141.8
    -배추가격: [2553.1716]
    # 21000 손실비용: 2270824.8
    -배추가격: [2556.1343]
    # 21500 손실비용: 2270514.5
    -배추가격: [2558.7703]
    # 22000 손실비용: 2270211.0
    -배추가격: [2561.1204]
    # 22500 손실비용: 2269912.0
    -배추가격: [2563.2095]
    # 23000 손실비용: 2269616.2
    -배추가격: [2565.0764]
    # 23500 손실비용: 2269323.8
    -배추가격: [2566.7336]
    # 24000 손실비용: 2269033.8
    -배추가격: [2568.2131]
    # 24500 손실비용: 2268745.5
    -배추가격: [2569.533]
    # 25000 손실비용: 2268459.0
    -배추가격: [2570.7078]
    # 25500 손실비용: 2268173.8
    -배추가격: [2571.755]
    # 26000 손실비용: 2267889.5
    -배추가격: [2572.693]
    # 26500 손실비용: 2267606.8
    -배추가격: [2573.5322]
    # 27000 손실비용: 2267323.8
    -배추가격: [2574.2722]
    # 27500 손실비용: 2267042.0
    -배추가격: [2574.927]
    # 28000 손실비용: 2266760.2
    -배추가격: [2575.5354]
    # 28500 손실비용: 2266479.8
    -배추가격: [2576.0647]
    # 29000 손실비용: 2266199.5
    -배추가격: [2576.555]
    # 29500 손실비용: 2265919.2
    -배추가격: [2576.9817]
    # 30000 손실비용: 2265639.0
    -배추가격: [2577.3582]
    # 30500 손실비용: 2265360.0
    -배추가격: [2577.6978]
    # 31000 손실비용: 2265081.2
    -배추가격: [2578.0244]
    # 31500 손실비용: 2264802.5
    -배추가격: [2578.2751]
    # 32000 손실비용: 2264523.5
    -배추가격: [2578.517]
    # 32500 손실비용: 2264244.8
    -배추가격: [2578.7588]
    # 33000 손실비용: 2263966.0
    -배추가격: [2578.992]
    # 33500 손실비용: 2263688.0
    -배추가격: [2579.1848]
    # 34000 손실비용: 2263410.0
    -배추가격: [2579.3176]
    # 34500 손실비용: 2263132.5
    -배추가격: [2579.4465]
    # 35000 손실비용: 2262855.8
    -배추가격: [2579.5747]
    # 35500 손실비용: 2262579.2
    -배추가격: [2579.7026]
    # 36000 손실비용: 2262302.5
    -배추가격: [2579.8303]
    # 36500 손실비용: 2262025.5
    -배추가격: [2579.9583]
    # 37000 손실비용: 2261749.2
    -배추가격: [2580.086]
    # 37500 손실비용: 2261473.0
    -배추가격: [2580.2114]
    # 38000 손실비용: 2261196.5
    -배추가격: [2580.3318]
    # 38500 손실비용: 2260920.2
    -배추가격: [2580.3914]
    # 39000 손실비용: 2260644.2
    -배추가격: [2580.4292]
    # 39500 손실비용: 2260368.2
    -배추가격: [2580.466]
    # 40000 손실비용: 2260093.8
    -배추가격: [2580.5027]
    # 40500 손실비용: 2259819.0
    -배추가격: [2580.5369]
    # 41000 손실비용: 2259544.0
    -배추가격: [2580.5696]
    # 41500 손실비용: 2259269.8
    -배추가격: [2580.603]
    # 42000 손실비용: 2258995.5
    -배추가격: [2580.6357]
    # 42500 손실비용: 2258721.8
    -배추가격: [2580.6692]
    # 43000 손실비용: 2258447.2
    -배추가격: [2580.7024]
    # 43500 손실비용: 2258173.5
    -배추가격: [2580.7354]
    # 44000 손실비용: 2257899.8
    -배추가격: [2580.769]
    # 44500 손실비용: 2257626.2
    -배추가격: [2580.8022]
    # 45000 손실비용: 2257352.8
    -배추가격: [2580.836]
    # 45500 손실비용: 2257079.8
    -배추가격: [2580.8694]
    # 46000 손실비용: 2256806.0
    -배추가격: [2580.903]
    # 46500 손실비용: 2256533.0
    -배추가격: [2580.9375]
    # 47000 손실비용: 2256260.2
    -배추가격: [2580.9736]
    # 47500 손실비용: 2255988.0
    -배추가격: [2581.0068]
    # 48000 손실비용: 2255716.8
    -배추가격: [2581.041]
    # 48500 손실비용: 2255445.2
    -배추가격: [2581.0764]
    # 49000 손실비용: 2255174.5
    -배추가격: [2581.1147]
    # 49500 손실비용: 2254903.0
    -배추가격: [2581.153]
    # 50000 손실비용: 2254632.5
    -배추가격: [2581.195]
    # 50500 손실비용: 2254361.2
    -배추가격: [2581.237]
    # 51000 손실비용: 2254090.8
    -배추가격: [2581.2795]
    # 51500 손실비용: 2253820.0
    -배추가격: [2581.3252]
    # 52000 손실비용: 2253549.5
    -배추가격: [2581.3713]
    # 52500 손실비용: 2253279.5
    -배추가격: [2581.4172]
    # 53000 손실비용: 2253009.2
    -배추가격: [2581.4634]
    # 53500 손실비용: 2252739.0
    -배추가격: [2581.5127]
    # 54000 손실비용: 2252469.2
    -배추가격: [2581.5625]
    # 54500 손실비용: 2252199.2
    -배추가격: [2581.6123]
    # 55000 손실비용: 2251930.8
    -배추가격: [2581.6567]
    # 55500 손실비용: 2251662.5
    -배추가격: [2581.701]
    # 56000 손실비용: 2251393.8
    -배추가격: [2581.7485]
    # 56500 손실비용: 2251125.5
    -배추가격: [2581.7969]
    # 57000 손실비용: 2250857.5
    -배추가격: [2581.8455]
    # 57500 손실비용: 2250589.2
    -배추가격: [2581.8933]
    # 58000 손실비용: 2250321.5
    -배추가격: [2581.9414]
    # 58500 손실비용: 2250054.2
    -배추가격: [2581.987]
    # 59000 손실비용: 2249787.8
    -배추가격: [2582.0293]
    # 59500 손실비용: 2249521.0
    -배추가격: [2582.0784]
    # 60000 손실비용: 2249255.0
    -배추가격: [2582.129]
    # 60500 손실비용: 2248989.2
    -배추가격: [2582.179]
    # 61000 손실비용: 2248722.8
    -배추가격: [2582.227]
    # 61500 손실비용: 2248457.0
    -배추가격: [2582.2605]
    # 62000 손실비용: 2248191.0
    -배추가격: [2582.2942]
    # 62500 손실비용: 2247925.0
    -배추가격: [2582.3271]
    # 63000 손실비용: 2247659.2
    -배추가격: [2582.3606]
    # 63500 손실비용: 2247394.2
    -배추가격: [2582.3945]
    # 64000 손실비용: 2247128.5
    -배추가격: [2582.4277]
    # 64500 손실비용: 2246863.0
    -배추가격: [2582.4614]
    # 65000 손실비용: 2246598.0
    -배추가격: [2582.495]
    # 65500 손실비용: 2246333.0
    -배추가격: [2582.5288]
    # 66000 손실비용: 2246068.2
    -배추가격: [2582.5627]
    # 66500 손실비용: 2245803.2
    -배추가격: [2582.6018]
    # 67000 손실비용: 2245538.5
    -배추가격: [2582.6523]
    # 67500 손실비용: 2245274.0
    -배추가격: [2582.7036]
    # 68000 손실비용: 2245009.5
    -배추가격: [2582.755]
    # 68500 손실비용: 2244745.2
    -배추가격: [2582.8054]
    # 69000 손실비용: 2244480.5
    -배추가격: [2582.8545]
    # 69500 손실비용: 2244216.5
    -배추가격: [2582.8997]
    # 70000 손실비용: 2243952.2
    -배추가격: [2582.9453]
    # 70500 손실비용: 2243688.5
    -배추가격: [2582.9883]
    # 71000 손실비용: 2243424.2
    -배추가격: [2583.0286]
    # 71500 손실비용: 2243160.8
    -배추가격: [2583.0686]
    # 72000 손실비용: 2242897.2
    -배추가격: [2583.108]
    # 72500 손실비용: 2242633.8
    -배추가격: [2583.1426]
    # 73000 손실비용: 2242370.5
    -배추가격: [2583.1775]
    # 73500 손실비용: 2242109.5
    -배추가격: [2583.2046]
    # 74000 손실비용: 2241848.5
    -배추가격: [2583.232]
    # 74500 손실비용: 2241588.0
    -배추가격: [2583.2542]
    # 75000 손실비용: 2241327.5
    -배추가격: [2583.2764]
    # 75500 손실비용: 2241067.0
    -배추가격: [2583.298]
    # 76000 손실비용: 2240807.0
    -배추가격: [2583.3203]
    # 76500 손실비용: 2240546.5
    -배추가격: [2583.3425]
    # 77000 손실비용: 2240286.5
    -배추가격: [2583.3623]
    # 77500 손실비용: 2240026.2
    -배추가격: [2583.3787]
    # 78000 손실비용: 2239766.5
    -배추가격: [2583.3955]
    # 78500 손실비용: 2239506.8
    -배추가격: [2583.4124]
    # 79000 손실비용: 2239247.0
    -배추가격: [2583.4292]
    # 79500 손실비용: 2238987.2
    -배추가격: [2583.4458]
    # 80000 손실비용: 2238728.0
    -배추가격: [2583.4626]
    # 80500 손실비용: 2238468.5
    -배추가격: [2583.4773]
    # 81000 손실비용: 2238209.2
    -배추가격: [2583.4888]
    # 81500 손실비용: 2237950.0
    -배추가격: [2583.5]
    # 82000 손실비용: 2237691.0
    -배추가격: [2583.5117]
    # 82500 손실비용: 2237432.0
    -배추가격: [2583.523]
    # 83000 손실비용: 2237173.2
    -배추가격: [2583.5347]
    # 83500 손실비용: 2236914.8
    -배추가격: [2583.546]
    # 84000 손실비용: 2236655.8
    -배추가격: [2583.5574]
    # 84500 손실비용: 2236397.0
    -배추가격: [2583.5688]
    # 85000 손실비용: 2236138.8
    -배추가격: [2583.5803]
    # 85500 손실비용: 2235880.5
    -배추가격: [2583.5884]
    # 86000 손실비용: 2235622.2
    -배추가격: [2583.5945]
    # 86500 손실비용: 2235364.2
    -배추가격: [2583.6008]
    # 87000 손실비용: 2235106.0
    -배추가격: [2583.607]
    # 87500 손실비용: 2234848.0
    -배추가격: [2583.6128]
    # 88000 손실비용: 2234590.2
    -배추가격: [2583.632]
    # 88500 손실비용: 2234332.8
    -배추가격: [2583.6665]
    # 89000 손실비용: 2234075.2
    -배추가격: [2583.7007]
    # 89500 손실비용: 2233817.8
    -배추가격: [2583.7349]
    # 90000 손실비용: 2233560.8
    -배추가격: [2583.7695]
    # 90500 손실비용: 2233305.0
    -배추가격: [2583.803]
    # 91000 손실비용: 2233050.5
    -배추가격: [2583.8372]
    # 91500 손실비용: 2232796.0
    -배추가격: [2583.8704]
    # 92000 손실비용: 2232541.5
    -배추가격: [2583.9045]
    # 92500 손실비용: 2232287.5
    -배추가격: [2583.9382]
    # 93000 손실비용: 2232033.0
    -배추가격: [2583.9727]
    # 93500 손실비용: 2231779.0
    -배추가격: [2584.0063]
    # 94000 손실비용: 2231525.0
    -배추가격: [2584.0403]
    # 94500 손실비용: 2231271.2
    -배추가격: [2584.0747]
    # 95000 손실비용: 2231017.5
    -배추가격: [2584.109]
    # 95500 손실비용: 2230764.0
    -배추가격: [2584.1426]
    # 96000 손실비용: 2230510.5
    -배추가격: [2584.1765]
    # 96500 손실비용: 2230257.5
    -배추가격: [2584.2107]
    # 97000 손실비용: 2230004.0
    -배추가격: [2584.2454]
    # 97500 손실비용: 2229751.2
    -배추가격: [2584.28]
    # 98000 손실비용: 2229497.8
    -배추가격: [2584.3147]
    # 98500 손실비용: 2229245.5
    -배추가격: [2584.3489]
    # 99000 손실비용: 2228992.5
    -배추가격: [2584.3838]
    # 99500 손실비용: 2228740.2
    -배추가격: [2584.4182]
    # 100000 손실비용: 2228487.5
    -배추가격: [2584.4526]
    


```python
#  학습 모델 저장하기 ~ 요청할때마다 하면 리소스가 너무낭비
saver = tf.train.Saver()

save_path = saver.save(sess, "./saved.cpkt")

print('학습된 모델을 저장했습니다.')
```

    학습된 모델을 저장했습니다.
    


```python

```
